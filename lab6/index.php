<?php
session_start();

// 1) –ü–æ –∑–∞—Ö–æ–¥—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–ø–∏—à–∏—Ç–µ –≤ —Å–µ—Å—Å–∏—é —Ç–µ–∫—Å—Ç 'test'. –ó–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–µ—Å—Å–∏–∏ –Ω–∞ —ç–∫—Ä–∞–Ω.
if (!isset($_SESSION['test'])) {
    $_SESSION['test'] = 'test';
}
echo "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–µ—Å—Å–∏–∏: " . $_SESSION['test'] . "<br>";

// 3) –°–¥–µ–ª–∞–π—Ç–µ —Å—á–µ—Ç—á–∏–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Å–µ—Å—Å–∏–∏. –°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –≤—ã–≤–æ–¥–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π. –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞—Ö–æ–¥–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–Ω –¥–æ–ª–∂–µ–Ω –≤—ã–≤–µ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–æ–º, —á—Ç–æ –≤—ã –µ—â–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É.
if (!isset($_SESSION['refresh_count'])) {
    $_SESSION['refresh_count'] = 0;
    echo "–í—ã –µ—â–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É<br>";
} else {
    $_SESSION['refresh_count']++;
    echo "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π: " . $_SESSION['refresh_count'] . "<br>";
}

// 5) –ó–∞–ø–∏—à–∏—Ç–µ –≤ —Å–µ—Å—Å–∏—é –≤—Ä–µ–º—è –∑–∞—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å–∞–π—Ç. –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—ã–≤–æ–¥–∏—Ç–µ —Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –Ω–∞–∑–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—à–µ–ª –Ω–∞ —Å–∞–π—Ç.
if (!isset($_SESSION['first_visit'])) {
    $_SESSION['first_visit'] = time();
}
$time_diff = time() - $_SESSION['first_visit'];
echo "–ü—Ä–æ—à–ª–æ —Å–µ–∫—É–Ω–¥ —Å –ø–µ—Ä–≤–æ–≥–æ –∑–∞—Ö–æ–¥–∞: " . $time_diff . "<br>";

// 7) –ü–æ –∑–∞—Ö–æ–¥—É –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∑–∞–ø–∏—à–∏—Ç–µ –≤ –∫—É–∫—É —Å –∏–º–µ–Ω–µ–º test —Ç–µ–∫—Å—Ç '123'. –ó–∞—Ç–µ–º –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –≤—ã–≤–µ–¥–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —ç—Ç–æ–π –∫—É–∫–∏ –Ω–∞ —ç–∫—Ä–∞–Ω.
if (!isset($_COOKIE['test'])) {
    setcookie('test', '123', time() + 3600);
    echo "–ö—É–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞<br>";
} else {
    echo "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫—É–∫–∏: " . $_COOKIE['test'] . "<br>";
}

// 9) –°–¥–µ–ª–∞–π—Ç–µ —Å—á–µ—Ç—á–∏–∫ –ø–æ—Å–µ—â–µ–Ω–∏—è —Å–∞–π—Ç–∞ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–º. –ö–∞–∂–¥—ã–π —Ä–∞–∑, –∑–∞—Ö–æ–¥—è –Ω–∞ —Å–∞–π—Ç, –æ–Ω –¥–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å –Ω–∞–¥–ø–∏—Å—å: '–í—ã –ø–æ—Å–µ—Ç–∏–ª–∏ –Ω–∞—à —Å–∞–π—Ç % —Ä–∞–∑!'.
if (!isset($_COOKIE['visit_count'])) {
    setcookie('visit_count', 1, time() + 31536000); // 1 –≥–æ–¥
    echo "–í—ã –ø–æ—Å–µ—Ç–∏–ª–∏ –Ω–∞—à —Å–∞–π—Ç 1 —Ä–∞–∑!<br>";
} else {
    $count = $_COOKIE['visit_count'] + 1;
    setcookie('visit_count', $count, time() + 31536000);
    echo "–í—ã –ø–æ—Å–µ—Ç–∏–ª–∏ –Ω–∞—à —Å–∞–π—Ç " . $count . " —Ä–∞–∑!<br>";
}

// 10) –°–ø—Ä–æ—Å–∏—Ç–µ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞—Ö–æ–¥–µ –Ω–∞ —Å–∞–π—Ç –Ω–∞–ø–∏—à–∏—Ç–µ —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –æ—Å—Ç–∞–ª–æ—Å—å –¥–æ –µ–≥–æ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è. –ï—Å–ª–∏ —Å–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –ø–æ–∑–¥—Ä–∞–≤—å—Ç–µ –µ–≥–æ!
if (!isset($_COOKIE['birthday'])) {
    if (isset($_POST['birthday'])) {
        setcookie('birthday', $_POST['birthday'], time() + 31536000);
        header("Location: " . $_SERVER['PHP_SELF']);
        exit;
    }
    ?>
    <form method="post">
        <label>–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É —Ä–æ–∂–¥–µ–Ω–∏—è (YYYY-MM-DD):</label>
        <input type="date" name="birthday" required>
        <input type="submit" value="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å">
    </form>
    <?php
} else {
    $birthday = new DateTime($_COOKIE['birthday']);
    $today = new DateTime();
    $birthday->setDate($today->format('Y'), $birthday->format('m'), $birthday->format('d'));
    
    if ($birthday < $today) {
        $birthday->modify('+1 year');
    }
    
    $interval = $today->diff($birthday);
    
    if ($interval->days == 0) {
        echo "–° –î–Ω–µ–º –†–æ–∂–¥–µ–Ω–∏—è! üéâ<br>";
    } else {
        echo "–î–æ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è –æ—Å—Ç–∞–ª–æ—Å—å " . $interval->days . " –¥–Ω–µ–π<br>";
    }
}
?>
